

<!DOCTYPE html>
<html lang="en">

<head>
    <title>GAN 学习笔记 - ce_amtic&#39;s</title>
<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="author" content="ce_amtic">
<meta name="description" content="欢迎来到 GAN 世界动物园！">
<meta name="keywords" content="">

<link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml">

    <meta charset="utf-8">
    <meta name="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="telephone=no" name="format-detection">
    <meta name="renderer" content="webkit">
    <meta name="theme-color" content="#ffffff">
    

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" crossorigin="anonymous">
<link rel="stylesheet" href="/css/journal.css?38813958">

<link rel="icon" href="/img/favicon.ico">


<link id="hljsThemeLight" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/atom-one-light.min.css" crossorigin="anonymous">
<link disabled id="hljsThemeDark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/atom-one-dark.min.css" crossorigin="anonymous">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif|Noto+Serif+SC|Fira+Code|Montserrat">
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Material+Icons">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>
<body>
<div id="top"></div>

<div id="app">
<div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            <a class="a-block drawer-menu-item false" href="/">
                Home
            </a>

            
                
                    <a class="a-block drawer-menu-item false"
                       href="/search">
                        Search
                    </a>
                
                    <a class="a-block drawer-menu-item false"
                       href="/categories">
                        Categories
                    </a>
                
                    <a class="a-block drawer-menu-item false"
                       href="/tags">
                        Tags
                    </a>
                
                    <a class="a-block drawer-menu-item false"
                       href="/archives">
                        Archive
                    </a>
                
                    <a class="a-block drawer-menu-item false"
                       href="/about">
                        About
                    </a>
                
            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="/">
            ce_amtic&#39;s
        </a>
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="/">
        <div class="single-column-header-title">ce_amtic&#39;s</div>
        <div class="single-column-header-subtitle"></div>
    </a>
</div>

<div ref="sideContainer" class="side-container">
    <a class="a-block nav-head false" href="/">
        <div class="nav-title">
            ce-amtic's.
        </div>
        <div class="nav-subtitle">
            长期素食导致的
        </div>
    </a>

    <div class="nav-link-list">
        
            
                <a class="a-block nav-link-item false"
                   href="/search">
                    Search
                </a>
            
                <a class="a-block nav-link-item false"
                   href="/categories">
                    Categories
                </a>
            
                <a class="a-block nav-link-item false"
                   href="/tags">
                    Tags
                </a>
            
                <a class="a-block nav-link-item false"
                   href="/archives">
                    Archive
                </a>
            
                <a class="a-block nav-link-item false"
                   href="/about">
                    About
                </a>
            
        
    </div>

    
    <div class="nav-footer">
        <!--button class="nav-footer-button" type="button" v-if="window.matchMedia('(prefers-color-scheme: dark)').matches">
            <i class="material-icons footer-button">dark_mode</i>
        </button>
        <button class="nav-footer-button" type="button" v-else>
            <i class="material-icons footer-button">light_mode</i>
        </button><br-->
        Built with <a href="https://hexo.io/" target="_blank">Hexo</a><br>
        
        Theme <a href="https://github.com/ce-amtic/hexo-theme-journal" target="_blank" rel="noreferrer noopener">Journal.</a> by <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a><br>
        
        &copy; 2024 <a target="_blank" rel="noopener" href="https://github.com/ce-amtic/ce-amtic.github.io/">ce_amtic</a>
    </div>
</div>

<div ref="extraContainer" class="extra-container">
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>

        
    </div>
</div>

    <!-- <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
            inlineMath:  [ ["$", "$"] ],
            displayMath: [ ["$$","$$"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a'],
            ignoreClass:"comment-content"
        },
        "HTML-CSS": {
            availableFonts: ["STIX","TeX"],
            showMathMenu: true
        }
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script> -->
<!-- <script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>





<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            <div class="post-head-wrapper-text-only"
                 style="background-image: url('')">
                <div class="post-title">
                    GAN 学习笔记
                    <div class="post-meta">
                        <time datetime="2023-12-09T13:55:00.000Z" itemprop="datePublished">
                            2023-12-09 21:55
                        </time>&nbsp;
                        
                        
                        <i class="material-icons no-hover" style="">folder</i>
                        
                        <a href='/categories/机器学习/'>机器学习</a>
                        
                        
    
                        
                    </div>
                </div>
            </div>
    
            <div class="post-body-wrapper">
                <div class="post-body">
                    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Network-as-Genertor"><span class="toc-number">1.</span> <span class="toc-text">Network as Genertor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ideas"><span class="toc-number">2.</span> <span class="toc-text">Ideas</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Features"><span class="toc-number">3.</span> <span class="toc-text">Features</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Theory"><span class="toc-number">4.</span> <span class="toc-text">Theory</span></a></li></ol>
                    <h3 id="Network-as-Genertor"><a href="#Network-as-Genertor" class="headerlink" title="Network as Genertor"></a>Network as Genertor</h3><p>普通的 neural network 读入一个向量，输出是一个确定的向量。如果加入一个 distribution 当作参数，那么输出也会成为一个 distribution。</p>
<p>为什么？考虑现实生活的随机性：一个事件有多种可能的结果，他们都是可能发生的，但又不会同时发生。</p>
<h3 id="Ideas"><a href="#Ideas" class="headerlink" title="Ideas"></a>Ideas</h3><p>训练两个部分：generator 和 discriminator (also neural nerwork function)。图片可以被视作巨大高维向量，然后作为 network 的输入。</p>
<blockquote>
<p><strong>discriminator</strong> </p>
<div class="plain-text">
<p>输入一张图片，输出一个数值项 scaler，表示定真的程度，数值越大越好。</p>
</div>
</blockquote>

<p>对抗的思路是，让 generator 和 discriminator 进行对抗迭代，discriminator 负责找出 gen 输出和参考值之间的差异。</p>
<p>Discriminator 的训练可以看作分类问题，也可以看成逻辑回归（regression）等等。Generator 的训练目标很简答：使 Discriminator 的输出值越大越好。</p>
<p>在实际处理中，将 Generator 和 Discriminator 拼接起来，视为一个更大的 network；这个network 中有一个 hidden layer，它的输出即是 Generator 的输出，不过在这里将其视为输出“维数很高”的一层。</p>
<p>整个 network 以一个向量作为输入，并输出一个分数。向量即是某个 distribution 的采样，分数即是 discriminator 的输出。Discriminator，也就是整个神经网络的最后几层的参数是不应调整的。所有调参都应对应着 Generator 所在的层。</p>
<h3 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h3><p>理论上，给定两个不同的向量，GAN 会生成两张不同的图片。如果在这两个向量对应的高维区间上做插值（interpolation），则会看到这两张图片的平滑过渡。</p>
<h3 id="Theory"><a href="#Theory" class="headerlink" title="Theory"></a>Theory</h3><p>对于 Generator 的训练形式化为：</p>
<p>$$ G^\text * &#x3D; arg\min_G Div(P_G, P_{Data})$$</p>
<p>其中 $P_G$ 是输出的分布，$P_{data}$ 是训练集（参考值）的分布，$Div$ 表示 Divergence 即两个分布之间的距离。Divergance 的计算公式有 KL Divergence, JS Divergence 等等，但是这些并不方便计算，因为我们不知道 $P_G$ 和 $P_{data}$ 的具体分布。GAN 的解决思路是：Sample is good enough，即 $P_G,P_{data}$ 的一个采样是容易获得的；在此基础上， Discriminator 会基于这些采样给出 Divergence 的预测值。</p>
<p>形式化地，Discriminator $D$ 的训练为：</p>
<p>$$\begin{align}D^\text * &#x3D; arg \max_D V(D, G), \text {where }V(D, G)&#x3D;E_{y\in P_{data}}(\log D(y))+E_{y\in P_G}(\log (1-D(y))) \end{align}$$</p>
<p>注意到 $V(D,G)$ 即是交叉熵的<strong>相反数</strong>，反比于数据的无序程度；也就是这里将其视为了一个二元逻辑回归问题，并把参考值标为 1，越接近 1 表示效果越好。</p>
<p>GAN 的理论是：最大的交叉熵跟 JS Divergence 有很高的相关性，于是可以有：</p>
<p>$$ G^\text * &#x3D; arg\min_G \max_D V(G,D)$$</p>

                </div>
            </div>
    
            
<nav class="post-pagination">
    
    <a class="newer-posts" href="/post/ml-notes/">
        Previous post<br>ML Notes
    </a>
    
    <span class="page-number"></span>
    
    <a class="older-posts" href="/post/icpc-buti/">
        Next post<br>ICPC 补题
    </a>
    
</nav>


    
            

<div class="post-comment-wrapper-giscus">
    <div class="giscus"></div>
</div>



        </div>
    </div>
    <div class="single-column-footer">
    <!--button class="nav-footer-button" type="button" v-if="localStorage.theme === 'dark'" v-on:click="toggleDark">
        Light Mode
    </button>
    <button class="nav-footer-button" type="button" v-else v-on:click="toggleDark">
        Dark Mode
    </button><br-->
    Built with <a href="https://hexo.io/" target="_blank">Hexo</a><br>
    
    Theme <a href="https://github.com/ce-amtic/hexo-theme-journal" target="_blank" rel="noreferrer noopener">Journal.</a> by <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a><br>
    
    &copy; 2024 <a href="https://ce-amtic.github.io">ce_amtic</a>
</div>
</div>

</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/smooth-scroll/14.2.1/smooth-scroll.min.js" crossorigin="anonymous"></script>
<script src="/js/journal.min.js?25681278"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="/js/clipboard.js"></script>
<script src="/js/darkmode.js"></script>




<script id="myGiscusApp"></script>
<script data-theme="preferred_color_scheme"
        src="https://giscus.app/client.js"
        
        data-repo="ce-amtic/ce-amtic.github.io"
        
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNjgzNTYwMTE="
        
        data-category="General"
        
        data-category-id="DIC_kwDOCgjoq84CVvut"
        
        data-mapping="pathname"
        
        data-reactions-enabled="1"
        
        data-emit-metadata="0"
        
        data-theme="light"
        
        data-lang="en"
        
        data-input-position="top"
        data-strict="1"
        crossorigin="anonymous"
        async>
</script>



</body>
</html>
